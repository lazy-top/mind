	<!DOCTYPE html>
	<html>
		<head>
			<meta charset="UTF-8">
			<!-- 引入 Vue 和 Vuetify 的 JS -->
			<script src="../js/vue.js"></script>
			<script src="../js/vuetify.js"></script>
			<script src="../js/socket.io.min.js"></script>
			<script src="../js/axios.min.js"></script>
			<script src="../js/vuex.global.min.js"></script>
			<script src="../js/three.min.js"></script>
			<script src="../js/echarts.min.js"></script>

			<!-- 引入 Vuetify 的 CSS -->
			<link href="../css/materialdesignicons.min.css" rel="stylesheet">
			<link href="../css/vuetify.min.css" rel="stylesheet">
			<meta name="viewport"
				content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
		</head>
		<body>
			<div id="app">







				<!--  -->
				<v-app id="inspire">
					<v-system-bar app>
						<v-spacer></v-spacer>
						<v-btn icon @click="showSettingsDialog">
							<!-- 设置图标 -->
							<v-icon>mdi-cog</v-icon>
						</v-btn>

						<!-- 切换日夜模式按钮 -->
						<v-btn icon @click="toggleDarkMode">
							<v-icon>{{ darkMode ? 'mdi-white-balance-sunny' : 'mdi-brightness-2' }}</v-icon>
						</v-btn>

						<!-- 切换多语言模型按钮 -->
						<v-btn icon @click="toggleLanguage">
							<v-icon>mdi-translate</v-icon>
						</v-btn>
					</v-system-bar>



					<v-navigation-drawer v-model="drawer" app absolute mini-variant>
						<v-avatar class="d-block text-center mx-auto mt-4" size="36">
							<v-img src="../img/a-lovely-human-being.png" alt="Image description"></v-img>
						</v-avatar>

						<v-divider class="mx-3 my-5"></v-divider>

						<v-btn icon size="28" class="d-block text-center mx-auto mb-9"
							@click="topage('/mind/views/chat.html')">
							<v-tooltip bottom>
								<template v-slot:activator="{ on }">
									<v-icon v-on="on">mdi-chat</v-icon>
								</template>
								<span>聊天</span>
							</v-tooltip>
						</v-btn>

						<v-btn icon size="28" class="d-block text-center mx-auto mb-9"
							@click="topage('/mind/views/data.html')">
							<v-tooltip bottom>
								<template v-slot:activator="{ on }">
									<v-icon v-on="on">mdi-database</v-icon>
								</template>
								<span>数据</span>
							</v-tooltip>
						</v-btn>

						<v-btn icon size="28" class="d-block text-center mx-auto mb-9"
							@click="topage('/mind/views/warning.html')">
							<v-tooltip bottom>
								<template v-slot:activator="{ on }">
									<v-icon v-on="on">mdi-alert</v-icon>
								</template>
								<span>警告</span>
							</v-tooltip>
						</v-btn>

						<!-- 添加 VR 图标按钮 -->
						<v-btn icon size="28" class="d-block text-center mx-auto mb-9"
							@click="topage('/mind/views/vr.html')">
							<v-tooltip bottom>
								<template v-slot:activator="{ on }">
									<v-icon v-on="on">mdi-eye</v-icon>
								</template>
								<span>VR</span>
							</v-tooltip>
						</v-btn>

						<!-- 添加知识库图标按钮 -->
						<v-btn icon size="28" class="d-block text-center mx-auto mb-9" @click="topage('')">
							<v-tooltip bottom>
								<template v-slot:activator="{ on }">
									<v-icon v-on="on">mdi-book-open-page-variant</v-icon>
								</template>
								<span>知识库</span>
							</v-tooltip>
						</v-btn>
					</v-navigation-drawer>

					<v-main>
						<label for="node-select">选择要显示的节点：</label>
						<select id="node-select"></select>
						<div id="graph" style="width: 100%; height: 600px;"></div>

					</v-main>

				</v-app>
			</div>
			<script src="../js/psychology_graph.js"></script>
			<script>

			</script>
			<script>
				new Vue({
					el: '#app',
					vuetify: new Vuetify({
						icons: {
							iconfont: 'mdi', // 默认图标集
						},
					}),
					data() {
						return {
							// 你的数据属性
							url: "http://127.0.0.1:8080/api",
							user_id: 0,
							dialog: false,
							drawer: true,
							darkMode: false,
							language: true, // 添加 language 属性
							showSettingsDialog: false

						}

					},
					methods: {
						openDialog() {
							this.dialog = true;
						},
						closeDialog() {
							this.dialog = false;
						},
						topage(route) {
							window.open(route, "_self")

						},
						getCookie(name) {
							const cookieMap = {};
							const cookies = document.cookie.split("; ");
							cookies.forEach(cookie => {
								const [key, value] = cookie.split("=");
								cookieMap[key] = value;
							});
							return cookieMap[name];
						},
						setCookie(name, value, days) {
							let expires = "";
							if (days) {
								const date = new Date();
								date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
								expires = "; expires=" + date.toUTCString();
							}
							document.cookie = name + "=" + (value || "") + expires + "; path=/";
						},
						toggleDarkMode() {
							this.darkMode = !this.darkMode;
							// 在这里可以添加切换日夜模式的逻辑
							this.$vuetify.theme.dark = !this.$vuetify.theme.dark;
						},

						toggleLanguage() {
							// 这里可以添加切换语言的逻辑
						},

					},
					beforeDestroy() {

					},
					mounted() {
						this.user_id = this.getCookie("user_id");

				const myChart = echarts.init(document.getElementById('graph'));

				const selectNode = document.getElementById('node-select');

				// 添加选项到选择框中
				p_nodes.forEach(node => {
					const option = document.createElement('option');
					option.value = node.name;
					option.textContent = node.name;
					selectNode.appendChild(option);
				});

				// 根据选择的节点重新绘制图形
				selectNode.addEventListener('change', function() {
					const selectedNode = this.value;
					const selectedLinks = p_links.filter(link => link.source === selectedNode || link
						.target === selectedNode);
					const relatedNodes = new Set();
					selectedLinks.forEach(link => {
						relatedNodes.add(link.source);
						relatedNodes.add(link.target);
					});
					const filteredNodes = p_nodes.filter(node => relatedNodes.has(node.name));
					myChart.setOption({
						series: [{
							type: 'graph',
							layout: 'force',
							symbolSize: 40,
							roam: true,
							edgeSymbol: ['circle', 'arrow'],
							edgeSymbolSize: [4, 10],
							edgeLabel: {
								show: true,
								fontSize: 12
							},
							data: filteredNodes,
							links: selectedLinks
						}]
					});
				});

				// 默认只显示第一个节点及其相关的边
				const defaultNode = p_nodes[0].name;
				const defaultLinks = p_links.filter(link => link.source === defaultNode || link.target ===
					defaultNode);
				const defaultRelatedNodes = new Set();
				defaultLinks.forEach(link => {
					defaultRelatedNodes.add(link.source);
					defaultRelatedNodes.add(link.target);
				});
				const defaultFilteredNodes = p_nodes.filter(node => defaultRelatedNodes.has(node.name));
				myChart.setOption({
					series: [{
						type: 'graph',
						layout: 'force',
						symbolSize: 40,
						roam: true,
						edgeSymbol: ['circle', 'arrow'],
						edgeSymbolSize: [4, 10],
						edgeLabel: {
							show: true,
							fontSize: 12
						},
						data: defaultFilteredNodes,
						links: defaultLinks
					}]
				});


					}

				})
			</script>
		</body>
	</html>